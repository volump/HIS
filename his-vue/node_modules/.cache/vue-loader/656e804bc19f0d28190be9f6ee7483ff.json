{"remainingRequest":"E:\\datebaseFinal\\his-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\datebaseFinal\\his-vue\\src\\views\\department\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\datebaseFinal\\his-vue\\src\\views\\department\\index.vue","mtime":1656215907617},{"path":"E:\\datebaseFinal\\his-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\datebaseFinal\\his-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\datebaseFinal\\his-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\datebaseFinal\\his-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZXBhcnRtZW50RWRpdCBmcm9tICdAL2NvbXBvbmVudHMvZGVwYXJ0bWVudC9lZGl0LnZ1ZScKaW1wb3J0IEJyZWFkY3J1bWIgZnJvbSAnQC9jb21wb25lbnRzL0JyZWFkY3J1bWInCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgICAgZGVwYXJ0X25hbWU6W10sCiAgICAgICAgaXNDb2xsYXBzZTogZmFsc2UsCiAgICAgICAgc2hvd0l0OiBmYWxzZSwKICAgICAgICAgY29sbGFwc2VCdG5DbGFzczogJ2VsLWljb24tcy1mb2xkJywKICAgICAgcXVlcnlJbmZvOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMjAKICAgICAgfSwKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgdG90YWw6IDAsCiAgICAgIHNob3c6IGZhbHNlLAogICAgICBlZGl0aWQ6IG51bGwsCiAgICAgIHNlbGVjdGVkcm93OiBbXSwKICAgICAgdGl0bGU6ICcnCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBEZXBhcnRtZW50RWRpdCwKICAgIEJyZWFkY3J1bWIKICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy5kcmF3Q2hhcnQoKQogIH0sCiAgbWV0aG9kczogewogICAgZHJhd0NoYXJ0KCkgewogICAgICB0aGlzLmdldERhdGEoKQogICAgICB2YXIgZGVwYXJ0X25hbWUyPVtdCiAgICAgIHZhciBkZXBhcl9jb3VudD1bXS8v5ZCE56eR5a6k5Lq65pWw5pWw57uECiAgICAgIHRoaXMuZGVwYXJ0X25hbWU9W10KICAgICAgdGhpcy4kYXhpb3MuaHR0cC5nZXQoJy91c2Vycy9OdW0nKS50aGVuKHJlc3BvbnNlPT57CiAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXNwb25zZS5kYXRhLnJlY29yZHMKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKQogICAgICAgICBmb3IodmFyIGk9MTtpPHJlc3BvbnNlLmRhdGEubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIGRlcGFyX2NvdW50LnB1c2gocmVzcG9uc2UuZGF0YVtpXS5jb3VudCkKICAgICAgICAgfQogICAgICAgICBkZXBhcnRfbmFtZTI9dGhpcy5kZXBhcnRfbmFtZQogICAgICAgIC8vY29uc29sZS5sb2coZGVwYXJfY291bnQpCiAgICAgICAgIGxldCBteUNoYXJ0ID0gdGhpcy4kZWNoYXJ0cy5pbml0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlY2hhcnRzXzIiKSk7CiAgICAgIC8vIOaMh+WumuWbvuihqOeahOmFjee9rumhueWSjOaVsOaNrgogICAgICBsZXQgb3B0aW9uID0gewogICAgICAgIHRpdGxlOiB7CiAgICAgICAgdGV4dDogIuWQhOenkeWupOS6uuaVsCIsCiAgICAgICAgfSwKICAgICAgICB0b29sdGlwOiB7fSwKICAgICAgICBsZWdlbmQ6IHsKICAgICAgICAgICAgZGF0YTogWyLlkITnp5HlrqTkurrmlbAiXSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgeEF4aXM6IHsKICAgICAgICAgIGRhdGE6ZGVwYXJ0X25hbWUyCiAgICAgICAgfSwKICAgICAgICB5QXhpczoge30sCiAgICAgICAgc2VyaWVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICLlkITnp5HlrqTkurrmlbAiLAogICAgICAgICAgICB0eXBlOiAiYmFyIiwKICAgICAgICAgICAgZGF0YTogZGVwYXJfY291bnQKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgfTsKICAgICAgLy8g5L2/55So5Yia5oyH5a6a55qE6YWN572u6aG55ZKM5pWw5o2u5pi+56S65Zu+6KGo44CCCiAgICAgIG15Q2hhcnQuc2V0T3B0aW9uKG9wdGlvbik7CiAgICAgIHRoaXMuZ2V0RGF0YSgpOwogICAgICB9KQogICAgfSwKICAgIGdldERhdGEgKCkgewogICAgICB0aGlzLiRheGlvcy5nZXQoJy91c2Vycy9OdW0zJywKICAgICAgICByZXNwb25zZSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygiTnVtMyBpcyAtLS0tPiIscmVzcG9uc2UpCiAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZGVwYXJ0X25hbWUpCiAgICAgICAgfSksCiAgICAgIHRoaXMuJGF4aW9zLmdldCgnL2RlcGFydG1lbnRzJywKICAgICAgICByZXNwb25zZSA9PiB7CiAgICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlc3BvbnNlLmRhdGEucmVjb3JkcwogICAgICAgICAgdGhpcy50b3RhbCA9IHBhcnNlSW50KHJlc3BvbnNlLmRhdGEudG90YWwpCiAgICAgICAgICBmb3IodmFyIGk9MDtpPHJlc3BvbnNlLmRhdGEucmVjb3Jkcy5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgdGhpcy5kZXBhcnRfbmFtZS5wdXNoKHJlc3BvbnNlLmRhdGEucmVjb3Jkc1tpXS5uYW1lKQogICAgICAgICAgfQogICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmRlcGFydF9uYW1lKQogICAgICAgIH0sCiAgICAgICAgdGhpcy5xdWVyeUluZm8sCiAgICAgICAgLy90aGlzLmRyYXdDaGFydCgpCiAgICAgICkKICAgIH0sCiAgICBoYW5kbGVFZGl0IChpZCkgewogICAgICB0aGlzLnRpdGxlID0gJ+S/ruaUueenkeWupCcKICAgICAgdGhpcy5lZGl0aWQgPSBpZAogICAgICB0aGlzLnNob3cgPSB0cnVlCiAgICB9LAogICAgYWRkICgpIHsKICAgICAgdGhpcy50aXRsZSA9ICfmt7vliqDnp5HlrqQnCiAgICAgIHRoaXMuZWRpdGlkID0gbnVsbAogICAgICB0aGlzLnNob3cgPSB0cnVlCiAgICB9LAogICAgaGFuZGxlRGVsZXRlIChpZCkgewogICAgICB0aGlzLiRheGlvcy5kZWwoYC9kZXBhcnRtZW50cy8ke2lkfWAsICgpID0+IHsKICAgICAgICBpZiAodGhpcy50b3RhbCA9PT0gKHRoaXMucXVlcnlJbmZvLnBhZ2UgLSAxKSAqIHRoaXMucXVlcnlJbmZvLmxpbWl0ICsgMSkgdGhpcy5xdWVyeUluZm8ucGFnZSAtPSAxCiAgICAgICB0aGlzLmRyYXdDaGFydCgpCiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlICh2YWwpIHsKICAgICAgLy8gdmFs5Y+C5pWw5Li65omA5pyJ6YCJ5Lit6KGM55qE5pWw5o2uCiAgICAgIHRoaXMuc2VsZWN0ZWRyb3cgPSB2YWwgLy8gWyB7fSAse30gLHt9ICAgIF0KICAgIH0sCiAgICBiYXRjaGRlbCAoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkcm93Lmxlbmd0aCA9PT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoJ+ayoeacieS7u+S9leiiq+mAieS4reeahOaVsOaNricpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgaWRzID0gW10KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VsZWN0ZWRyb3cubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlkcy5wdXNoKHRoaXMuc2VsZWN0ZWRyb3dbaV0uaWQpCiAgICAgICAgfQogICAgICAgIHRoaXMuJGF4aW9zLmRlbCgnL2RlcGFydG1lbnRzL2JhdGNoZGVsJywKICAgICAgICAgICgpID0+IHsKICAgICAgICAgICAgaWYgKHRoaXMudG90YWwgPT09ICh0aGlzLnF1ZXJ5SW5mby5wYWdlIC0gMSkgKiB0aGlzLnF1ZXJ5SW5mby5saW1pdCArIGlkcy5sZW5ndGgpIHRoaXMucXVlcnlJbmZvLnBhZ2UgLT0gMQogICAgICAgICAgICB0aGlzLmRyYXdDaGFydCgpCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBpZHM6IGlkcy5qb2luKCcsJykKICAgICAgICAgIH0KICAgICAgICApCiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVTaXplQ2hhbmdlIChuZXdTaXplKSB7CiAgICAgIHRoaXMucXVlcnlJbmZvLmxpbWl0ID0gbmV3U2l6ZQogICAgICB0aGlzLmRyYXdDaGFydCgpCiAgICB9LAogICAgLy8g55uR5ZCsIOmhteeggeWAvCDmlLnlj5jnmoTkuovku7YKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UgKG5ld1BhZ2UpIHsKICAgICAgdGhpcy5xdWVyeUluZm8ucGFnZSA9IG5ld1BhZ2UKICAgICB0aGlzLmRyYXdDaGFydCgpCiAgICB9LAogICAgLy8g55uR5ZCsIHN3aXRjaCDlvIDlhbPnirbmgIHnmoTmlLnlj5gKICAgIHN0YXRlQ2hhbmdlZCAoaW5mbykgewogICAgICBjb25zdCBhY3RpdmUgPSBpbmZvLmFjdGl2ZSA9PT0gMSA/IDAgOiAxCiAgICAgIHRoaXMuJGF4aW9zLnB1dChgL2RlcGFydG1lbnRzLyR7aW5mby5pZH0vc3RhdGUvJHthY3RpdmV9YCwgcmVzcG9uc2UgPT4gewogICAgICAgIGluZm8uYWN0aXZlID0gYWN0aXZlCiAgICAgIH0pCiAgICB9LAogICAgIGNvbGxhcHNlKCl7ICAvL+aUtue8qQp0aGlzLmRyYXdDaGFydCgpCiAgICAgICAgICAgICAgICB0aGlzLmlzQ29sbGFwc2UgPSAhdGhpcy5pc0NvbGxhcHNlOwogICAgICAgICAgICAgICAgaWYodGhpcy5pc0NvbGxhcHNlKXsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNlQnRuQ2xhc3MgPSAnZWwtaWNvbi1zLXVuZm9sZCc7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dUZXh0U2hvdyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0l0ID0gIXRoaXMuc2hvd0l0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNlQnRuQ2xhc3MgPSAnZWwtaWNvbi1zLWZvbGQnOwogICAgICAgICAgICAgICAgICAgIHRoaXMubG9nVGV4dFNob3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0l0ID0gIXRoaXMuc2hvd0l0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/department","sourcesContent":["<template>\n\n  <div>\n        <div style=\"flex: 1; font-size: 18px\">\n        <span :class=\"collapseBtnClass\" style=\"cursor: pointer; font-size: 20px\" @click=\"collapse\"></span>\n        </div>\n    <div id=\"echarts_2\" style=\"width: 1000px; height: 400px\" v-show=\"showIt\"></div>\n    <Breadcrumb msg1=\"基本信息管理\" msg2=\"科室列表\" />\n\n    <!-- 卡片视图区域 -->\n    <el-card>\n      <el-row :gutter=\"10\">\n        <el-col :span=\"10\">\n          <el-input v-model=\"queryInfo.name\" placeholder=\"请输入要查的科室名\" clearable @clear=\"getData\">\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getData\"></el-button>\n          </el-input>\n        </el-col>\n        <el-col :span=\"14\">\n          <el-button type=\"primary\" icon=\"el-icon-circle-plus-outline\" plain @click=\"add()\">添加科室</el-button>\n          <el-button type=\"warning\" icon=\"el-icon-delete\" plain @click=\"batchdel()\">批量删除</el-button>\n        </el-col>\n      </el-row>\n\n      <el-table\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        @selection-change=\"handleSelectionChange\"\n      >\n        <el-table-column type=\"selection\"></el-table-column>\n        <el-table-column label=\"id\"  prop=\"id\"></el-table-column>\n        <el-table-column label=\"科室名称\" prop=\"name\"> </el-table-column>\n        <el-table-column label=\"办公地址\" prop=\"address\"></el-table-column>\n        <el-table-column label=\"负责人\" prop=\"leader\"> </el-table-column>\n        <el-table-column label=\"是否有效\" width=\"100\">\n          <template slot-scope=\"scope\">\n            <el-switch\n              :value=\"scope.row.active === 1\"\n              active-color=\"#13ce66\"\n              inactive-color=\"#ff4949\"\n              @change=\"stateChanged(scope.row)\"\n              >\n            </el-switch>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"220px\">\n          <template slot-scope=\"scope\">\n              <el-button type=\"primary\" icon=\"el-icon-edit\" circle @click=\"handleEdit(scope.row.id)\"></el-button>\n              <el-button type=\"danger\" icon=\"el-icon-delete\" circle  @click=\"handleDelete(scope.row.id)\"></el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <!-- 分页区域 -->\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"queryInfo.page\"\n        :page-sizes=\"[3, 5, 10, 20]\"\n        :page-size=\"queryInfo.limit\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      ></el-pagination>\n    </el-card>\n\n    <el-dialog :title=\"title\" :visible.sync=\"show\" :close-on-click-modal=\"false\" width=\"500px\">\n      <DepartmentEdit v-if=\"show\" :show.sync=\"show\" @getData=\"getData()\" :editid=\"editid\"></DepartmentEdit>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport DepartmentEdit from '@/components/department/edit.vue'\nimport Breadcrumb from '@/components/Breadcrumb'\nexport default {\n  data () {\n    return {\n        depart_name:[],\n        isCollapse: false,\n        showIt: false,\n         collapseBtnClass: 'el-icon-s-fold',\n      queryInfo: {\n        name: '',\n        page: 1,\n        limit: 20\n      },\n      tableData: [],\n      total: 0,\n      show: false,\n      editid: null,\n      selectedrow: [],\n      title: ''\n    }\n  },\n  components: {\n    DepartmentEdit,\n    Breadcrumb\n  },\n  created () {\n    this.drawChart()\n  },\n  methods: {\n    drawChart() {\n      this.getData()\n      var depart_name2=[]\n      var depar_count=[]//各科室人数数组\n      this.depart_name=[]\n      this.$axios.http.get('/users/Num').then(response=>{\n        this.tableData = response.data.records\n        console.log(response.data)\n         for(var i=1;i<response.data.length;i++){\n            depar_count.push(response.data[i].count)\n         }\n         depart_name2=this.depart_name\n        //console.log(depar_count)\n         let myChart = this.$echarts.init(document.getElementById(\"echarts_2\"));\n      // 指定图表的配置项和数据\n      let option = {\n        title: {\n        text: \"各科室人数\",\n        },\n        tooltip: {},\n        legend: {\n            data: [\"各科室人数\"],\n              },\n          xAxis: {\n          data:depart_name2\n        },\n        yAxis: {},\n        series: [\n          {\n            name: \"各科室人数\",\n            type: \"bar\",\n            data: depar_count\n          },\n        ],\n      };\n      // 使用刚指定的配置项和数据显示图表。\n      myChart.setOption(option);\n      this.getData();\n      })\n    },\n    getData () {\n      this.$axios.get('/users/Num3',\n        response => {\n          console.log(\"Num3 is ---->\",response)\n          //console.log(this.depart_name)\n        }),\n      this.$axios.get('/departments',\n        response => {\n          this.tableData = response.data.records\n          this.total = parseInt(response.data.total)\n          for(var i=0;i<response.data.records.length;i++){\n            this.depart_name.push(response.data.records[i].name)\n          }\n          //console.log(this.depart_name)\n        },\n        this.queryInfo,\n        //this.drawChart()\n      )\n    },\n    handleEdit (id) {\n      this.title = '修改科室'\n      this.editid = id\n      this.show = true\n    },\n    add () {\n      this.title = '添加科室'\n      this.editid = null\n      this.show = true\n    },\n    handleDelete (id) {\n      this.$axios.del(`/departments/${id}`, () => {\n        if (this.total === (this.queryInfo.page - 1) * this.queryInfo.limit + 1) this.queryInfo.page -= 1\n       this.drawChart()\n      })\n    },\n    handleSelectionChange (val) {\n      // val参数为所有选中行的数据\n      this.selectedrow = val // [ {} ,{} ,{}    ]\n    },\n    batchdel () {\n      if (this.selectedrow.length === 0) {\n        this.$message('没有任何被选中的数据')\n      } else {\n        const ids = []\n        for (let i = 0; i < this.selectedrow.length; i++) {\n          ids.push(this.selectedrow[i].id)\n        }\n        this.$axios.del('/departments/batchdel',\n          () => {\n            if (this.total === (this.queryInfo.page - 1) * this.queryInfo.limit + ids.length) this.queryInfo.page -= 1\n            this.drawChart()\n          },\n          {\n            ids: ids.join(',')\n          }\n        )\n      }\n    },\n    handleSizeChange (newSize) {\n      this.queryInfo.limit = newSize\n      this.drawChart()\n    },\n    // 监听 页码值 改变的事件\n    handleCurrentChange (newPage) {\n      this.queryInfo.page = newPage\n     this.drawChart()\n    },\n    // 监听 switch 开关状态的改变\n    stateChanged (info) {\n      const active = info.active === 1 ? 0 : 1\n      this.$axios.put(`/departments/${info.id}/state/${active}`, response => {\n        info.active = active\n      })\n    },\n     collapse(){  //收缩\nthis.drawChart()\n                this.isCollapse = !this.isCollapse;\n                if(this.isCollapse){\n                    this.collapseBtnClass = 'el-icon-s-unfold';\n                    this.logTextShow = false;\n                    this.showIt = !this.showIt;\n                }\n                else{\n                    this.collapseBtnClass = 'el-icon-s-fold';\n                    this.logTextShow = true;\n                    this.showIt = !this.showIt;\n                }\n            }\n  }\n}\n</script>\n<style scoped>\n</style>\n"]}]}